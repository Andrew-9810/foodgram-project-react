# Foodgram - продуктовый помощник
## Описание проекта
Сервис позволяет пользователям публиковать рецепты,
подписываться на публикации других пользователей, 
добавлять понравившиеся рецепты в список «Избранное»,
а перед походом в магазин скачивать сводный список продуктов,
необходимых для приготовления одного или нескольких выбранных блюд.

Адрес ресурса: 51.250.24.84
Администрато: login: an@mail.ru password:an1234an

## Запуск проекта на локальной машине:
Клонировать репозиторий:
`https://github.com/Andrew-9810/foodgram-project-react`
В корневой директории проекта файл .env заполнить своими данными:
```
POSTGRES_DB=foot
POSTGRES_USER=foot_user
POSTGRES_PASSWORD=foot_password
DB_HOST=db
DB_PORT=5432
DEBUG=False
SECRET_KEY='секретный ключ Django'
```
Создать и запустить контейнеры Docker, выполнить команду в терминале из корневой директории проекта:
```
docker-compose up -d
```
После успешной сборки выполнить миграции:
```
docker-compose exec backend python manage.py migrate
```
Собрать статику:
```
docker-compose exec backend python manage.py collectstatic
```
Копирование статики в рабочую диреторию:
```
docker compose exec backend cp -r /app/collected_static/. /backend_static/static/ 
```
Создать суперпользователя:
```
docker-compose exec backend python manage.py createsuperuser
```
Наполнить базу данных содержимым из файла ingredients.json:
```
docker-compose exec backend python manage.py loaddata ingredients.json
```

После запуска проект будут доступен по адресу: http://localhost/

Документация будет доступна по адресу: http://localhost/api/docs/

## Технологии: 
- Python
- Django
- Django REST Framework
- PostgreSQL
- NGINX
- Gunicorn
- Docker
- GitHub Actions

## Как использовать проект:

Без аудентификации на проекте вам будут доступны:
- Получение списка рецептов;
- Получение данных отдельного рецепта;
- Получение списока пользователей;
- Получение токена авторизации;
- Регистрация пользователя.

Для аудентификации вам необходимо получить JWT токен, далее вам доступен функционал:
- Получение списка рецептов;
- Создание рецепта;
- Получение данных отдельного рецепта;
- Обновление данных рецепта текущего пользователя;
- Удаление данных рецепта текущего пользователя;
- Получение данных другого пользователя;
- Получение данных подписок текущего пользователя;
- Подписаться на пользователя;
- Отписаться от пользователя;
- Получение данных избранных рецептов текущего пользователя;
- Добавить рецепт в избраное;
- Удалить рецепт из избраного;
- Добавить рецепт в список покупок;
- Удалить рецепт из списка покупок;
- Загрузка списока покупок;
- Получение списка тегов;
- Получение данных отдельного тега;
- Получение списка ингридиентов;
- Получение данных отдельного ингридиента.


## База данных (пример):

Таблица users
|id|password |last_login |is_siperuser|usermame    |last_name  |email                |is_staff|is_active|date_joined               |first_name|
|--|:-------:|:---------:|:----------:|:----------:|:---------:|:-------------------:|:------:|:-------:|:------------------------:|:---------|
|1 |******** |           |1           |an          |an         |an@mail.ru           |1       |1        |2023-05-28 12:08:27.302971|an        |
|2 |******** |           |            |vasya.pupkin|Пупкин     |vpupkin@yandex.ru    |0       |1        |2023-05-28 12:08:27.302971|Вася      |
|3 |******** |           |            |second-user |Макаревский|second_user@email.org|0       |1        |2023-05-28 12:08:27.302971|Андрей    |

Таблица follow
|id|author_id|user_id|
|--|:-------:|:------|
|3 |2        |1      |

Таблица tegs
|id|name   |color  |slug   |
|--|:-----:|:-----:|:------|
|1 |Zavtrac|#1FFFC3|Zavtrac|
|2 |Obed   |#FFFFFF|Obed   |
|3 |Ужин   |#2CFFE3|Yjin   |

Таблица ingridients
|id|name               |measurement_unit|
|--|:-----------------:|:---------------|
|1 |абрикосовое варенье|г               |
|2 |абрикосовое пюре   |г               |

Таблица recipes
|id|name                    |text                           |pub_date                  |image|author_id|cooking_time|
|--|:----------------------:|:-----------------------------:|:------------------------:|:---:|:-------:|:-----------|
|6 |Рецепт от Васи          |Суп по Васински                |2023-05-29 02:53:10.886509|     |2        |15          |
|7 |Суп как у мамы          |Возми Добавь И все будет хорошо|2023-05-29 02:53:10.886509|     |3        |13          |
|7 |Рецепт от Администратора|Просто рецепт!                 |2023-05-29 02:53:10.886509|     |1        |18          |

Таблица amountingridients
|id|ingridient_id|recipe_id|amount|
|--|:-----------:|:-------:|:-----|
|9 |1            |6        |3     |
|10|2            |7        |4     |
|11|1            |8        |1     |
|12|2            |9        |2     |

Таблица recipe_tags
|id|recipe_id|tag_id|
|--|:-------:|:-----|
|9 |6        |1     |
|10|6        |2     |
|11|7        |1     |
|12|8        |2     |

Таблица favoriterecipe
|id|recipe_id|user_id|
|--|:-------:|:------|
|2 |7        |3      |

Таблица shoppinglist
|id|recipe_id|user_id|
|--|:-------:|:------|
|  |         |       |


## Примеры запросов к API

### Регистрация пользователя

#### POST запрос

```
/api/users/
```

##### Тело запроса
```
{
    "email": "test@yandex.ru",
    "username": "test",
    "first_name": "test",
    "last_name": "test",
    "password": "test1234test"
}
```

#### Ответ от сервера
```
{
    "id": 5,
    "username": "test",
    "first_name": "test",
    "last_name": "test",
    "email": "test@yandex.ru"
}
```
#### Статус код ответа от сервера 201 Created

-------------------------------------------

### Получение списка пользователей

#### GET запрос
```
/api/users/
```

#### Ответ от сервера
```
{
    "count": 5,
    "next": null,
    "previous": null,
    "results": [
        {
            "email": "an@mail.ru",
            "id": 1,
            "username": "an",
            "first_name": "an",
            "last_name": "an",
            "is_subscribed": false
        },
        {
            "email": "vpupkin@yandex.ru",
            "id": 2,
            "username": "vasya.pupkin",
            "first_name": "Вася",
            "last_name": "Пупкин",
            "is_subscribed": false
        },
        {
            "email": "second_user@email.org",
            "id": 3,
            "username": "second-user",
            "first_name": "Андрей",
            "last_name": "Макаревский",
            "is_subscribed": false
        },
        {
            "email": "third-user@user.ru",
            "id": 4,
            "username": "third-user-username",
            "first_name": "Гордон",
            "last_name": "Рамзиков",
            "is_subscribed": false
        },
        {
            "email": "test@yandex.ru",
            "id": 5,
            "username": "test",
            "first_name": "test",
            "last_name": "test",
            "is_subscribed": false
        }
    ]
}
```
#### Статус код ответа от сервера 200 OK

----------------------------------------------------------------------------

### Получение токена (аудентификация)

#### POST запрос
```
/api/auth/token/login/
```

##### Тело запроса
```
{
    "email": "test@yandex.ru",
    "password": "test1234test"
}
```

#### Ответ от сервера
```
{
    "auth_token": "e196ff457190f1e1d2c826ab474105b3955897b2"
}
```
#### Статус код ответа от сервера 201 Created

----------------------------------------------------------------------------

### Получение профиля пользователя

#### GET запрос 

```
/api/users/3
```

#### Ответ от сервера
```
{
    "email": "second_user@email.org",
    "id": 3,
    "username": "second-user",
    "first_name": "Андрей",
    "last_name": "Макаревский",
    "is_subscribed": false
}
```
#### Статус код ответа от сервера 200 OK

-----------------------------------------

### Получение списка тегов

#### GET запрос

  
```
/api/tags/
```

#### Ответ от сервера
```
[
    {
        "id": 1,
        "name": "Zavtrac",
        "color": "#1FFFC3",
        "slug": "Zavtrac"
    },
    {
        "id": 2,
        "name": "Obed",
        "color": "#FFFFFF",
        "slug": "Obed"
    },
    {
        "id": 3,
        "name": "Ужин",
        "color": "#2CFFE3",
        "slug": "Yjin"
    }
]
```
#### Статус код ответа от сервера 200 OK

-----------------------------------------

### Получение списка ингридиентов

#### GET запрос

  
```
/api/ingredients/
```

#### Ответ от сервера
```
[
    {
        "id": 1,
        "name": "абрикосовое варенье",
        "measurement_unit": "г"
    },
    {
        "id": 2,
        "name": "абрикосовое пюре",
        "measurement_unit": "г"
    }
]
```
#### Статус код ответа от сервера 200 OK

-----------------------------------------

### Создание поста

#### POST запрос
Обязательные поля: text

##### Анонимные запросы запрещены (пройдите аудентификацию)
В разделе **Получение токена (аудентификация)** прошли аудентификацию от имени автора leo, далее все созданные нами посты будут создаваться от имени автора leo.  
```
api/v1/posts/
```

##### Тело запроса
```
{
    "text": "Лучше знать немного истинно хорошего и нужного, чем очень много посредственного и ненужного."
}
```

#### Ответ от сервера
```
{
    "id": 6,
    "author": "leo",
    "text": "Лучше знать немного истинно хорошего и нужного, чем очень много посредственного и ненужного.",
    "pub_date": "2023-06-01T03:42:53.128449Z",
    "image": null,
    "group": null
}
```
#### Статус код ответа от сервера 201 Created
-----------------------------------------------

### Получение поста

#### GET запрос
Получим пост с id равный 2.
```
/api/v1/posts/2/
```

#### Ответ от сервера
```
{
    "id": 2,
    "author": "russia",
    "text": "Не имей сто рублей, а имей сто друзей.",
    "pub_date": "2023-05-29T02:53:10.886509Z",
    "image": null,
    "group": null
}
```
#### Статус код ответа от сервера 200 OK
-----------------------------------------

### Обновление поста

#### PUT запрос
Обязательные поля: text.
Изменим текст поста и группу.

##### Анонимные запросы запрещены (пройдите аудентификацию)
В разделе **Получение токена (аудентификация)** прошли аудентификацию от имени автора leo, далее мы можем редактировать посты созданные только от имени автора leo. 
```
api/v1/posts/5/
```

##### Тело запроса
```
{
    "text": "Если нет сил гореть и разливать свет, то хоть не засти его. Решил обновить пост!",
    "group": 2
}
```

#### Ответ от сервера
```
{
    "id": 5,
    "author": "leo",
    "text": "Если нет сил гореть и разливать свет, то хоть не засти его. Решил обновить пост!",
    "pub_date": "2023-05-29T02:53:10.886509Z",
    "image": null,
    "group": 2
}
```
#### Статус код ответа от сервера 200 OK
-----------------------------------------
### Частичное обновление поста

#### PATCH запрос
Обязательные поля: text.
Изменим группу.

##### Анонимные запросы запрещены (пройдите аудентификацию)
В разделе **Получение токена (аудентификация)** прошли аудентификацию от имени автора leo, далее мы можем редактировать посты созданные только от имени автора leo.  
```
api/v1/posts/5/
```

##### Тело запроса
```
{
    "text": "Если нет сил гореть и разливать свет, то хоть не засти его. Решил обновить пост!",
    "group": 1
}
```

#### Ответ от сервера
```
{
    "id": 5,
    "author": "leo",
    "text": "Если нет сил гореть и разливать свет, то хоть не засти его. Решил обновить пост!",
    "pub_date": "2023-05-29T02:53:10.886509Z",
    "image": null,
    "group": 1
}
```
#### Статус код ответа от сервера 200 OK
-----------------------------------------

### Удаление поста

#### DELETE запрос

##### Анонимные запросы запрещены (пройдите аудентификацию)
В разделе **Получение токена (аудентификация)** прошли аудентификацию от имени автора leo, далее мы можем удалять посты созданные только от имени автора leo.  
```
api/v1/posts/6/
```
#### Статус код ответа от сервера 204 No Content
---------------------------------------------------------------------------------------------------------------

### Получение комментариев к посту

#### GET запрос
Обязательные поля: post_id.

Получим комментарии к 1 посту. 
```
api/v1/posts/1/comments/
```

#### Ответ от сервера
```
[
    {
        "id": 1,
        "author": "leo",
        "text": "Хорошо сказано!",
        "created": "2023-05-29T03:48:27.571726Z",
        "post": 1
    }
]
```
#### Статус код ответа от сервера 200 ОК
-----------------------------------------

### Добавление комментария
#### POST запрос
Обязательные поля: post_id; text.
Создадим комментарий к 4 посту.

##### Анонимные запросы запрещены (пройдите аудентификацию)
В разделе **Получение токена (аудентификация)** прошли аудентификацию от имени автора leo, далее все созданные нами комментарии будут создаваться от имени автора leo.  
```
api/v1/posts/4/comments/
```

#### Тело запроса
```
{
    "text": "Умно!"
}
```

#### Ответ от сервера
```
{
    "id": 4,
    "author": "leo",
    "text": "Умно!",
    "created": "2023-06-01T06:06:41.933458Z",
    "post": 4
}
```
#### Статус код ответа от сервера 201 Created
----------------------------------------

### Обновление комментария

#### PUT запрос
Обязательные поля: post_id; id; text.
Отредактируем комментарий к 4 посту.

##### Анонимные запросы запрещены (пройдите аудентификацию)
В разделе **Получение токена (аудентификация)** прошли аудентификацию от имени автора leo,
далее мы можем редактировать комментарии созданные только от имени автора leo.
```
api/v1/posts/4/comments/4/
```

##### Тело запроса
```
{
    "text": "Умно! И спору не поддается!"
}
```

#### Ответ от сервера
```
{
    "id": 4,
    "author": "leo",
    "text": "Умно! И спору не поддается!",
    "created": "2023-06-01T06:06:41.933458Z",
    "post": 4
}
```
#### Статус код ответа от сервера 200 OK
-----------------------------------------

### Частичное обновление коментария

#### PATCH запрос
Обязательные поля: post_id; id; text.
Отредактируем комментарий к 4 посту.

##### Анонимные запросы запрещены (пройдите аудентификацию)
В разделе **Получение токена (аудентификация)** прошли аудентификацию от имени автора leo,
далее мы можем редактировать комментарии созданные только от имени автора leo.
```
api/v1/posts/4/comments/4/
```

##### Тело запроса
```
{
    "text": "Умно!"
}
```

#### Ответ от сервера
```
{
    "id": 4,
    "author": "leo",
    "text": "Умно!",
    "created": "2023-06-01T06:06:41.933458Z",
    "post": 4
}
```
#### Статус код ответа от сервера 200 OK
--------------------------------------------

### Удаление комментария

#### DELETE запрос
Удалим созданный нами коментарий к 4 посту.

##### Анонимные запросы запрещены (пройдите аудентификацию)
В разделе **Получение токена (аудентификация)** прошли аудентификацию от имени автора leo, далее мы можем удалять комментарии созданные только от имени автора leo.
```
api/v1/posts/4/comments/4/
```
#### Статус код ответа от сервера 204 No Content
----------------------------------------------------------------------------

### Получение списка групп

#### GET запрос
```
api/v1/groups/
```

#### Ответ от сервера
```
[
    {
        "id": 1,
        "title": "Отечественные",
        "slug": "domestic",
        "description": "Отечественные писатели"
    },
    {
        "id": 2,
        "title": "Зарубежные",
        "slug": "foreign",
        "description": "Зарубежные писатели"
    }
]
```
#### Статус код ответа от сервера 200 ОК
---------------------------------------------

### Получение информации об одной группе
Обязательные поля: id.
Получим информацию по 1 группе.

#### GET запрос
```
api/v1/groups/1/
```

#### Ответ от сервера
```
{
    "id": 1,
    "title": "Отечественные",
    "slug": "domestic",
    "description": "Отечественные писатели"
}
```
#### Статус код ответа от сервера 200 ОК
------------------------------------------------------------------

### Подписаться
Обязательные поля: following (поле username из таблицы user)
Подпишемся на Алесандра Пушкина с id = 4, он же following = 4.

#### POST запрос

##### Анонимные запросы запрещены (пройдите аудентификацию)
В разделе **Получение токена (аудентификация)** прошли аудентификацию от имени автора leo, далее мы можем создавать подписки только от имени автора leo.
```
api/v1/follow/
```

##### Тело запроса
```
{
    "following": "alex"
}
```

#### Ответ от сервера
```
{
    "id": 3,
    "user": "leo",
    "following": "alex"
}
```
#### Статус код ответа от сервера 201 Created
-------------------------------------------------

### Получение всех подписок пользователя

#### GET запрос

##### Анонимные запросы запрещены (пройдите аудентификацию)
В разделе **Получение токена (аудентификация)** прошли аудентификацию от имени автора leo, далее мы можем просматривать подписки созданные только от имени автора leo.
```
api/v1/follow/
```

#### Ответ от сервера
```
[
    {
        "id": 3,
        "user": "leo",
        "following": "alex"
    }
]
```
#### Статус код ответа от сервера 200 OK

## Автор:
Голованов Андрей

